<!--
Copyright 2025 Shota FUJI <pockawoooh@gmail.com>
SPDX-License-Identifier: MIT
-->
{{ define "repo-blob-ref" -}}
<!DOCTYPE html>
<html lang="en">
	<head>
		{{ template "head" }}
		{{- $path := "" -}}
		{{- $name := "" -}}
		{{- range .Path -}}
		{{- $path = printf "%s/%s" $path . -}}
		{{- $name = . -}}
		{{- end -}}
		<title>
			{{ $path }} at {{ .Meta.Ref }} - {{ .Meta.DisplayName }}
		</title>
		<meta name="description" content='{{ $path }} in {{ .Meta.DisplayName }}' />
	</head>
	<body>
		<header>
			<ol>
				<li>
					<a href="/">Top</a>
				</li>
				<li>
					<a href="/{{ .Meta.DisplayName }}">{{ .Meta.DisplayName }}</a>
				</li>
				<li>
					<a href="/{{ .Meta.DisplayName }}/tree/{{ .Meta.Ref }}">Files</a>
				</li>
				{{- $path_slice := .Path -}}
				{{- $meta := .Meta }}
				{{ range $i, $segment := .Path -}}
				<li>
					{{- $trail := "" -}}
					{{- range $j, $seg := $path_slice -}}
					{{- if le $j $i }}
					{{- $trail = printf "%s/%s" $trail $seg -}}
					{{- end -}}
					{{- end -}}
					{{- $type := "tree" -}}
					{{- if eq $segment $name -}}
					{{- $type = "blob" -}}
					{{- end -}}
					<a href="/{{ $meta.DisplayName }}/{{ $type }}/{{ $meta.Ref }}{{ $trail }}">{{ $segment }}</a>
				</li>
				{{- end }}
			</ol>
			<span>{{ .Meta.DisplayName }}</span>
			{{ if .Meta.Description -}}
			<p>{{ .Meta.Description }}</p>
			{{- end -}}
		</header>
		{{ template "repo-nav" . }}
		<main>
			<div style="display:grid;grid-template-columns:max-content minmax(0,1fr);gap:1px 1ch;font-family:monospace;line-height:1.3;">
				<ol style="list-style:none;padding:0;">
					{{- range .LineNumbers -}}
					<li>
						<a id="L{{ . }}" href="#L{{ . }}">{{ . }}</a>
					</li>
					{{- end -}}
				</ol>
				{{ if .SyntaxHighlightedContent -}}
				{{ .SyntaxHighlightedContent }}
				{{- else -}}
				<pre><code>
					{{- .Content -}}
				</code></pre>
				{{- end }}
			</div>
		</main>
	</body>
</html>
{{- end }}
